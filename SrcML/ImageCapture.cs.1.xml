<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<unit xmlns="http://www.sdml.info/srcML/src" xmlns:cpp="http://www.sdml.info/srcML/cpp" xmlns:lit="http://www.sdml.info/srcML/literal" xmlns:op="http://www.sdml.info/srcML/operator" xmlns:type="http://www.sdml.info/srcML/modifier" xmlns:pos="http://www.sdml.info/srcML/position" language="C#" filename="C:\Users\USDASHE1\Documents\Visual Studio 2012\Projects\sandoHead\Indexer\Indexer.UnitTests\TestFiles\CS_1\ImageCapture.cs" pos:tabs="8" pos:line="1" pos:column="1">   <cpp:region pos:line="1" pos:column="4">#<cpp:directive pos:line="1" pos:column="5">region</cpp:directive> License Information</cpp:region>

<comment type="block" pos:line="3" pos:column="1">/**********************************************************************************
Shared Source License for Cropper
Copyright 9/07/2004 Brian Scott
http://blogs.geekdojo.net/brian

This license governs use of the accompanying software ('Software'), and your
use of the Software constitutes acceptance of this license.

You may use the Software for any commercial or noncommercial purpose,
including distributing derivative works.

In return, we simply require that you agree:
1. Not to remove any copyright or other notices from the Software. 
2. That if you distribute the Software in source code form you do so only
   under this license (i.e. you must include a complete copy of this license
   with your distribution), and if you distribute the Software solely in
   object form you only do so under a license that complies with this
   license.
3. That the Software comes "as is", with no warranties. None whatsoever.
   This means no express, implied or statutory warranty, including without
   limitation, warranties of merchantability or fitness for a particular
   purpose or any warranty of title or non-infringement. Also, you must pass
   this disclaimer on whenever you distribute the Software or derivative
   works.
4. That no contributor to the Software will be liable for any of those types
   of damages known as indirect, special, consequential, or incidental
   related to the Software or this license, to the maximum extent the law
   permits, no matter what legal theory it�s based on. Also, you must pass
   this limitation of liability on whenever you distribute the Software or
   derivative works.
5. That if you sue anyone over patents that you think may apply to the
   Software for a person's use of the Software, your license to the Software
   ends automatically.
6. That the patent rights, if any, granted in this license only apply to the
   Software, not to any derivative works you make.
7. That the Software is subject to U.S. export jurisdiction at the time it
   is licensed to you, and it may be subject to additional export or import
   laws in other places.  You agree to comply with all such laws and
   regulations that may apply to the Software after delivery of the software
   to you.
8. That if you are an agency of the U.S. Government, (i) Software provided
   pursuant to a solicitation issued on or after December 1, 1995, is
   provided with the commercial license rights set forth in this license,
   and (ii) Software provided pursuant to a solicitation issued prior to
   December 1, 1995, is provided with �Restricted Rights� as set forth in
   FAR, 48 C.F.R. 52.227-14 (June 1987) or DFAR, 48 C.F.R. 252.227-7013
   (Oct 1988), as applicable.
9. That your rights under this License end automatically if you breach it in
   any way.
10.That all rights not expressly granted to you in this license are reserved.

**********************************************************************************/</comment>

<cpp:endregion pos:line="56" pos:column="1">#<cpp:directive pos:line="56" pos:column="2">endregion</cpp:directive></cpp:endregion>

<cpp:region pos:line="58" pos:column="1">#<cpp:directive pos:line="58" pos:column="2">region</cpp:directive> Using Directives</cpp:region>

<using pos:line="60" pos:column="1">using <name pos:line="60" pos:column="7">System</name>;</using>
<using pos:line="61" pos:column="1">using <name><name pos:line="61" pos:column="7">System</name><op:operator pos:line="61" pos:column="13">.</op:operator><name pos:line="61" pos:column="14">ComponentModel</name></name>;</using>
<using pos:line="62" pos:column="1">using <name><name pos:line="62" pos:column="7">System</name><op:operator pos:line="62" pos:column="13">.</op:operator><name pos:line="62" pos:column="14">Drawing</name></name>;</using>
<using pos:line="63" pos:column="1">using <name><name pos:line="63" pos:column="7">System</name><op:operator pos:line="63" pos:column="13">.</op:operator><name pos:line="63" pos:column="14">IO</name></name>;</using>
<using pos:line="64" pos:column="1">using <name><name pos:line="64" pos:column="7">Fusion8</name><op:operator pos:line="64" pos:column="14">.</op:operator><name pos:line="64" pos:column="15">Cropper</name><op:operator pos:line="64" pos:column="22">.</op:operator><name pos:line="64" pos:column="23">Extensibility</name></name>;</using>
<using pos:line="65" pos:column="1">using <name><name pos:line="65" pos:column="7">System</name><op:operator pos:line="65" pos:column="13">.</op:operator><name pos:line="65" pos:column="14">Windows</name><op:operator pos:line="65" pos:column="21">.</op:operator><name pos:line="65" pos:column="22">Forms</name></name>;</using>

<cpp:endregion pos:line="67" pos:column="1">#<cpp:directive pos:line="67" pos:column="2">endregion</cpp:directive></cpp:endregion>

<namespace pos:line="69" pos:column="1">namespace <name><name pos:line="69" pos:column="11">Fusion8</name><op:operator pos:line="69" pos:column="18">.</op:operator><name pos:line="69" pos:column="19">Cropper</name><op:operator pos:line="69" pos:column="26">.</op:operator><name pos:line="69" pos:column="27">Core</name></name>
<block pos:line="70" pos:column="1">{
    <comment type="line" pos:line="71" pos:column="5">/// &lt;summary&gt;</comment>
    <comment type="line" pos:line="72" pos:column="5">/// Represents a class for managing the capturing and saving of screenshots.</comment>
    <comment type="line" pos:line="73" pos:column="5">/// &lt;/summary&gt;</comment>
    <class><specifier pos:line="74" pos:column="5">public</specifier> class <name pos:line="74" pos:column="18">ImageCapture</name> <super pos:line="74" pos:column="31">: <name pos:line="74" pos:column="33">Component</name>, <name pos:line="74" pos:column="44">IPersistableOutput</name></super>
    <block pos:line="75" pos:column="5">{

        <decl_stmt><decl><type><specifier pos:line="77" pos:column="9">private</specifier> <name pos:line="77" pos:column="17">IPersistableImageFormat</name></type> <name pos:line="77" pos:column="41">imageFormat</name></decl>;</decl_stmt>
        <decl_stmt><decl><type><specifier pos:line="78" pos:column="9">private</specifier> <name pos:line="78" pos:column="17">Rectangle</name></type> <name pos:line="78" pos:column="27">captureRectangle</name></decl>;</decl_stmt>
        private readonly <macro><name pos:line="79" pos:column="26">FileNameTemplate</name></macro> <template pos:line="79" pos:column="43">template = <param><type><specifier pos:line="79" pos:column="54">new</specifier></type> <name pos:line="79" pos:column="58">FileNameTemplate</name><argument_list pos:line="79" pos:column="74">()</argument_list></param><empty_stmt pos:line="79" pos:column="76">;</empty_stmt></template>
        <decl_stmt><decl><type><specifier pos:line="80" pos:column="9">private</specifier> <name pos:line="80" pos:column="17">string</name></type> <name pos:line="80" pos:column="24">lastImageCaptured</name></decl>;</decl_stmt>

        <decl_stmt><decl><type><specifier pos:line="82" pos:column="9">private</specifier> <specifier pos:line="82" pos:column="17">static</specifier> <name pos:line="82" pos:column="24">ImageOutputCollection</name></type> <name pos:line="82" pos:column="46">imageOutputCollection</name></decl>;</decl_stmt>

        <comment type="line" pos:line="84" pos:column="9">/// &lt;summary&gt;</comment>
        <comment type="line" pos:line="85" pos:column="9">/// Required designer variable.</comment>
        <comment type="line" pos:line="86" pos:column="9">/// &lt;/summary&gt;</comment>
        <decl_stmt><decl><type><specifier pos:line="87" pos:column="9">private</specifier> <name pos:line="87" pos:column="17">Container</name></type> <name pos:line="87" pos:column="27">components</name></decl>;</decl_stmt>

        <comment type="line" pos:line="89" pos:column="9">/// &lt;summary&gt;</comment>
        <comment type="line" pos:line="90" pos:column="9">/// The &lt;see cref="IPersistableImageFormat"/&gt;object to use when saving an image.</comment>
        <comment type="line" pos:line="91" pos:column="9">/// &lt;/summary&gt;</comment>
        <decl_stmt><decl><type><attribute pos:line="92" pos:column="9">[<expr><call><name pos:line="92" pos:column="10">Browsable</name><argument_list pos:line="92" pos:column="19">(<argument><expr><lit:literal type="boolean" pos:line="92" pos:column="20">false</lit:literal></expr></argument>)</argument_list></call></expr><op:operator pos:line="92" pos:column="26">,</op:operator>
         <expr><call><name pos:line="93" pos:column="10">DesignerSerializationVisibility</name><argument_list pos:line="93" pos:column="41">(<argument><expr><name><name pos:line="93" pos:column="42">DesignerSerializationVisibility</name><op:operator pos:line="93" pos:column="73">.</op:operator><name pos:line="93" pos:column="74">Hidden</name></name></expr></argument>)</argument_list></call></expr>]</attribute>
        <specifier pos:line="94" pos:column="9">public</specifier> <name pos:line="94" pos:column="16">IPersistableImageFormat</name></type> <name pos:line="94" pos:column="40">ImageFormat</name>
        <block pos:line="95" pos:column="9">{
            <function><name pos:line="96" pos:column="13">get</name> <block pos:line="96" pos:column="17">{ <return pos:line="96" pos:column="19">return <expr><name pos:line="96" pos:column="26">imageFormat</name></expr>;</return> }</block></function>
            <function><name pos:line="97" pos:column="13">set</name>
            <block pos:line="98" pos:column="13">{
                <if pos:line="99" pos:column="17">if <condition pos:line="99" pos:column="20">(<expr><name pos:line="99" pos:column="21">imageFormat</name> <op:operator pos:line="99" pos:column="33">!=</op:operator> <name pos:line="99" pos:column="36">null</name></expr>)</condition><then pos:line="99" pos:column="41">
                <block pos:line="100" pos:column="17">{
                    <expr_stmt><expr><call><name><name pos:line="101" pos:column="21">imageFormat</name><op:operator pos:line="101" pos:column="32">.</op:operator><name pos:line="101" pos:column="33">Disconnect</name></name><argument_list pos:line="101" pos:column="43">()</argument_list></call></expr>;</expr_stmt>
                    <template pos:line="102" pos:column="21">template.<param><type/><name pos:line="102" pos:column="30">ResetIncrement</name><argument_list pos:line="102" pos:column="44">()</argument_list></param><empty_stmt pos:line="102" pos:column="46">;</empty_stmt></template>
                }</block></then></if>
                <expr_stmt><expr><name pos:line="104" pos:column="17">imageFormat</name> <op:operator pos:line="104" pos:column="29">=</op:operator> <name pos:line="104" pos:column="31">value</name></expr>;</expr_stmt>
                <if pos:line="105" pos:column="17">if <condition pos:line="105" pos:column="20">(<expr><name pos:line="105" pos:column="21">imageFormat</name> <op:operator pos:line="105" pos:column="33">!=</op:operator> <name pos:line="105" pos:column="36">null</name></expr>)</condition><then pos:line="105" pos:column="41">
                <block pos:line="106" pos:column="17">{
                    <expr_stmt><expr><call><name><name pos:line="107" pos:column="21">imageFormat</name><op:operator pos:line="107" pos:column="32">.</op:operator><name pos:line="107" pos:column="33">Connect</name></name><argument_list pos:line="107" pos:column="40">(<argument><expr><name pos:line="107" pos:column="41">this</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <expr_stmt><expr><call><name pos:line="108" pos:column="21">OnImageCaptureInitialized</name><argument_list pos:line="108" pos:column="46">(<argument><expr><op:operator pos:line="108" pos:column="47">new</op:operator> <call><name pos:line="108" pos:column="51">ImageCaptureInitializedEventArgs</name><argument_list pos:line="108" pos:column="83">()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                }</block></then></if>
            }</block></function>
        }</block></decl></decl_stmt>

        <comment type="line" pos:line="113" pos:column="9">/// &lt;summary&gt;</comment>
        <comment type="line" pos:line="114" pos:column="9">/// A collection of loaded image output plugins.</comment>
        <comment type="line" pos:line="115" pos:column="9">/// &lt;/summary&gt;</comment>
        <decl_stmt><decl><type><specifier pos:line="116" pos:column="9">public</specifier> <specifier pos:line="116" pos:column="16">static</specifier> <name pos:line="116" pos:column="23">ImageOutputCollection</name></type> <name pos:line="116" pos:column="45">ImageOutputs</name>
        <block pos:line="117" pos:column="9">{
            <function><name pos:line="118" pos:column="13">get</name>
            <block pos:line="119" pos:column="13">{
                <expr_stmt><expr><call><name pos:line="120" pos:column="17">EnsureOutputsLoaded</name><argument_list pos:line="120" pos:column="36">()</argument_list></call></expr>;</expr_stmt>
                <return pos:line="121" pos:column="17">return <expr><name pos:line="121" pos:column="24">imageOutputCollection</name></expr>;</return>
            }</block></function>
        }</block></decl></decl_stmt>

        <function><type><specifier pos:line="125" pos:column="9">private</specifier> <specifier pos:line="125" pos:column="17">static</specifier> <name pos:line="125" pos:column="24">void</name></type> <name pos:line="125" pos:column="29">EnsureOutputsLoaded</name><parameter_list pos:line="125" pos:column="48">()</parameter_list>
        <block pos:line="126" pos:column="9">{
            <if pos:line="127" pos:column="13">if <condition pos:line="127" pos:column="16">(<expr><name pos:line="127" pos:column="17">imageOutputCollection</name> <op:operator pos:line="127" pos:column="39">==</op:operator> <name pos:line="127" pos:column="42">null</name></expr>)</condition><then pos:line="127" pos:column="47">
            <block pos:line="128" pos:column="13">{
                <expr_stmt><expr><name pos:line="129" pos:column="17">imageOutputCollection</name> <op:operator pos:line="129" pos:column="39">=</op:operator> <call><name><name pos:line="129" pos:column="41">Plugins</name><op:operator pos:line="129" pos:column="48">.</op:operator><name pos:line="129" pos:column="49">Load</name></name><argument_list pos:line="129" pos:column="53">()</argument_list></call></expr>;</expr_stmt>
                <foreach pos:line="130" pos:column="17">foreach (<init><decl><type><name pos:line="130" pos:column="26">IPersistableImageFormat</name></type> <name pos:line="130" pos:column="50">format</name> <init pos:line="130" pos:column="57">in <expr><name pos:line="130" pos:column="60">imageOutputCollection</name></expr></init></decl></init>)
                <block pos:line="131" pos:column="17">{
                    <decl_stmt><decl><type><name pos:line="132" pos:column="21">IConfigurablePlugin</name></type> <name pos:line="132" pos:column="41">plugin</name> =<init pos:line="132" pos:column="49"> <expr><name pos:line="132" pos:column="50">format</name> <op:operator pos:line="132" pos:column="57">as</op:operator> <name pos:line="132" pos:column="60">IConfigurablePlugin</name></expr></init></decl>;</decl_stmt>
                    <if pos:line="133" pos:column="21">if <condition pos:line="133" pos:column="24">(<expr><name pos:line="133" pos:column="25">plugin</name> <op:operator pos:line="133" pos:column="32">!=</op:operator> <name pos:line="133" pos:column="35">null</name> <op:operator pos:line="133" pos:column="40">&amp;&amp;</op:operator> <name><name pos:line="133" pos:column="43">plugin</name><op:operator pos:line="133" pos:column="49">.</op:operator><name pos:line="133" pos:column="50">Settings</name></name> <op:operator pos:line="133" pos:column="59">!=</op:operator> <name pos:line="133" pos:column="62">null</name></expr>)</condition><then pos:line="133" pos:column="67">
                    <block pos:line="134" pos:column="21">{
                        <decl_stmt><decl><type><name pos:line="135" pos:column="25">object</name></type> <name pos:line="135" pos:column="32">settings</name> =<init pos:line="135" pos:column="42"> <expr><call><name><name pos:line="135" pos:column="43">Configuration</name><op:operator pos:line="135" pos:column="56">.</op:operator><name pos:line="135" pos:column="57">Current</name><op:operator pos:line="135" pos:column="64">.</op:operator><name pos:line="135" pos:column="65">RetrieveSettingsForPlugin</name></name><argument_list pos:line="135" pos:column="90">(<argument><expr><call><name><name pos:line="135" pos:column="91">plugin</name><op:operator pos:line="135" pos:column="97">.</op:operator><name pos:line="135" pos:column="98">Settings</name><op:operator pos:line="135" pos:column="106">.</op:operator><name pos:line="135" pos:column="107">GetType</name></name><argument_list pos:line="135" pos:column="114">()</argument_list></call></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
                        <if pos:line="136" pos:column="25">if <condition pos:line="136" pos:column="28">(<expr><name pos:line="136" pos:column="29">settings</name> <op:operator pos:line="136" pos:column="38">!=</op:operator> <name pos:line="136" pos:column="41">null</name></expr>)</condition><then pos:line="136" pos:column="46">
                            <expr_stmt><expr><name><name pos:line="137" pos:column="29">plugin</name><op:operator pos:line="137" pos:column="35">.</op:operator><name pos:line="137" pos:column="36">Settings</name></name> <op:operator pos:line="137" pos:column="45">=</op:operator> <name pos:line="137" pos:column="47">settings</name></expr>;</expr_stmt></then></if>
                    }</block></then></if>
                }</block></foreach>
            }</block></then></if>
        }</block></function>

        <comment type="line" pos:line="143" pos:column="9">/// &lt;summary&gt;</comment>
        <comment type="line" pos:line="144" pos:column="9">/// Last image captured</comment>
        <comment type="line" pos:line="145" pos:column="9">/// &lt;/summary&gt;</comment>
        <decl_stmt><decl><type><specifier pos:line="146" pos:column="9">public</specifier> <name pos:line="146" pos:column="16">string</name></type> <name pos:line="146" pos:column="23">LastImageCaptured</name>
        <block pos:line="147" pos:column="9">{
            <function><name pos:line="148" pos:column="13">get</name> <block pos:line="148" pos:column="17">{ <return pos:line="148" pos:column="19">return <expr><name pos:line="148" pos:column="26">lastImageCaptured</name></expr>;</return> }</block></function>
        }</block></decl></decl_stmt>


        <constructor><specifier pos:line="152" pos:column="9">public</specifier> <name pos:line="152" pos:column="16">ImageCapture</name><parameter_list pos:line="152" pos:column="28">(<param><decl><type><name pos:line="152" pos:column="29">IContainer</name></type> <name pos:line="152" pos:column="40">container</name></decl></param>)</parameter_list>
            <member_list pos:line="153" pos:column="13">: <call><name pos:line="153" pos:column="15">this</name><argument_list pos:line="153" pos:column="19">()</argument_list></call>
        </member_list><block pos:line="154" pos:column="9">{
            <expr_stmt><expr><call><name><name pos:line="155" pos:column="13">container</name><op:operator pos:line="155" pos:column="22">.</op:operator><name pos:line="155" pos:column="23">Add</name></name><argument_list pos:line="155" pos:column="26">(<argument><expr><name pos:line="155" pos:column="27">this</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        }</block></constructor>

        <constructor><specifier pos:line="158" pos:column="9">public</specifier> <name pos:line="158" pos:column="16">ImageCapture</name><parameter_list pos:line="158" pos:column="28">()</parameter_list>
        <block pos:line="159" pos:column="9">{
            <expr_stmt><expr><call><name pos:line="160" pos:column="13">InitializeComponent</name><argument_list pos:line="160" pos:column="32">()</argument_list></call></expr>;</expr_stmt>
        }</block></constructor>

        <comment type="line" pos:line="163" pos:column="9">/// &lt;summary&gt;</comment>
        <comment type="line" pos:line="164" pos:column="9">/// Required method for Designer support - do not modify</comment>
        <comment type="line" pos:line="165" pos:column="9">/// the contents of this method with the code editor.</comment>
        <comment type="line" pos:line="166" pos:column="9">/// &lt;/summary&gt;</comment>
        <function><type><specifier pos:line="167" pos:column="9">private</specifier> <name pos:line="167" pos:column="17">void</name></type> <name pos:line="167" pos:column="22">InitializeComponent</name><parameter_list pos:line="167" pos:column="41">()</parameter_list>
        <block pos:line="168" pos:column="9">{
            <expr_stmt><expr><name pos:line="169" pos:column="13">components</name> <op:operator pos:line="169" pos:column="24">=</op:operator> <op:operator pos:line="169" pos:column="26">new</op:operator> <call><name pos:line="169" pos:column="30">Container</name><argument_list pos:line="169" pos:column="39">()</argument_list></call></expr>;</expr_stmt>
        }</block></function>

        <comment type="line" pos:line="172" pos:column="9">/// &lt;summary&gt; </comment>
        <comment type="line" pos:line="173" pos:column="9">/// Clean up any resources being used.</comment>
        <comment type="line" pos:line="174" pos:column="9">/// &lt;/summary&gt;</comment>
        <function><type><specifier pos:line="175" pos:column="9">protected</specifier> <specifier pos:line="175" pos:column="19">override</specifier> <name pos:line="175" pos:column="28">void</name></type> <name pos:line="175" pos:column="33">Dispose</name><parameter_list pos:line="175" pos:column="40">(<param><decl><type><name pos:line="175" pos:column="41">bool</name></type> <name pos:line="175" pos:column="46">disposing</name></decl></param>)</parameter_list>
        <block pos:line="176" pos:column="9">{
            <if pos:line="177" pos:column="13">if <condition pos:line="177" pos:column="16">(<expr><name pos:line="177" pos:column="17">disposing</name></expr>)</condition><then pos:line="177" pos:column="27">
            <block pos:line="178" pos:column="13">{
                <if pos:line="179" pos:column="17">if <condition pos:line="179" pos:column="20">(<expr><name pos:line="179" pos:column="21">components</name> <op:operator pos:line="179" pos:column="32">!=</op:operator> <name pos:line="179" pos:column="35">null</name></expr>)</condition><then pos:line="179" pos:column="40">
                <block pos:line="180" pos:column="17">{
                    <expr_stmt><expr><call><name><name pos:line="181" pos:column="21">components</name><op:operator pos:line="181" pos:column="31">.</op:operator><name pos:line="181" pos:column="32">Dispose</name></name><argument_list pos:line="181" pos:column="39">()</argument_list></call></expr>;</expr_stmt>
                }</block></then></if>
            }</block></then></if>
            <expr_stmt><expr><call><name><name pos:line="184" pos:column="13">base</name><op:operator pos:line="184" pos:column="17">.</op:operator><name pos:line="184" pos:column="18">Dispose</name></name><argument_list pos:line="184" pos:column="25">(<argument><expr><name pos:line="184" pos:column="26">disposing</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        }</block></function>

        <comment type="line" pos:line="187" pos:column="9">/// &lt;summary&gt;</comment>
        <comment type="line" pos:line="188" pos:column="9">/// Captures a screenshot and raises events that notify the loaded plugin.</comment>
        <comment type="line" pos:line="189" pos:column="9">/// &lt;/summary&gt;</comment>
        <comment type="line" pos:line="190" pos:column="9">/// &lt;exception cref="InvalidOperationException"&gt;Thrown when the &lt;see cref="ImageFormat"/&gt; </comment>
        <comment type="line" pos:line="191" pos:column="9">/// has not been properly set.&lt;/exception&gt;</comment>
        <function><type><specifier pos:line="192" pos:column="9">public</specifier> <name pos:line="192" pos:column="16">void</name></type> <name pos:line="192" pos:column="21">Capture</name><parameter_list pos:line="192" pos:column="28">(<param><decl><type><name pos:line="192" pos:column="29">Rectangle</name></type> <name pos:line="192" pos:column="39">captureArea</name></decl></param>)</parameter_list>
        <block pos:line="193" pos:column="9">{
            <expr_stmt><expr><call><name pos:line="194" pos:column="13">Capture</name><argument_list pos:line="194" pos:column="20">(<argument><expr><name><name pos:line="194" pos:column="21">captureArea</name><op:operator pos:line="194" pos:column="32">.</op:operator><name pos:line="194" pos:column="33">Location</name></name></expr></argument><op:operator pos:line="194" pos:column="41">,</op:operator> <argument><expr><name><name pos:line="194" pos:column="43">captureArea</name><op:operator pos:line="194" pos:column="54">.</op:operator><name pos:line="194" pos:column="55">Size</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        }</block></function>

        <comment type="line" pos:line="197" pos:column="9">/// &lt;summary&gt;</comment>
        <comment type="line" pos:line="198" pos:column="9">/// Captures a screenshot and raises events that notify the loaded plugin.</comment>
        <comment type="line" pos:line="199" pos:column="9">/// &lt;/summary&gt;</comment>
        <comment type="line" pos:line="200" pos:column="9">/// &lt;exception cref="InvalidOperationException"&gt;Thrown when the &lt;see cref="ImageFormat"/&gt; </comment>
        <comment type="line" pos:line="201" pos:column="9">/// has not been properly set.&lt;/exception&gt;</comment>
        <function><type><specifier pos:line="202" pos:column="9">public</specifier> <name pos:line="202" pos:column="16">void</name></type> <name pos:line="202" pos:column="21">Capture</name><parameter_list pos:line="202" pos:column="28">(<param><decl><type><name pos:line="202" pos:column="29">Point</name></type> <name pos:line="202" pos:column="35">location</name></decl></param><op:operator pos:line="202" pos:column="43">,</op:operator> <param><decl><type><name pos:line="202" pos:column="45">Size</name></type> <name pos:line="202" pos:column="50">size</name></decl></param>)</parameter_list>
        <block pos:line="203" pos:column="9">{
            <expr_stmt><expr><call><name pos:line="204" pos:column="13">Capture</name><argument_list pos:line="204" pos:column="20">(<argument><expr><name><name pos:line="204" pos:column="21">location</name><op:operator pos:line="204" pos:column="29">.</op:operator><name pos:line="204" pos:column="30">X</name></name></expr></argument><op:operator pos:line="204" pos:column="31">,</op:operator> <argument><expr><name><name pos:line="204" pos:column="33">location</name><op:operator pos:line="204" pos:column="41">.</op:operator><name pos:line="204" pos:column="42">Y</name></name></expr></argument><op:operator pos:line="204" pos:column="43">,</op:operator> <argument><expr><name><name pos:line="204" pos:column="45">size</name><op:operator pos:line="204" pos:column="49">.</op:operator><name pos:line="204" pos:column="50">Width</name></name></expr></argument><op:operator pos:line="204" pos:column="55">,</op:operator> <argument><expr><name><name pos:line="204" pos:column="57">size</name><op:operator pos:line="204" pos:column="61">.</op:operator><name pos:line="204" pos:column="62">Height</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        }</block></function>

        <comment type="line" pos:line="207" pos:column="9">/// &lt;summary&gt;</comment>
        <comment type="line" pos:line="208" pos:column="9">/// Captures a screenshot and raises events that notify the loaded plugin.</comment>
        <comment type="line" pos:line="209" pos:column="9">/// &lt;/summary&gt;</comment>
        <comment type="line" pos:line="210" pos:column="9">/// &lt;exception cref="InvalidOperationException"&gt;Thrown when the &lt;see cref="ImageFormat"/&gt; </comment>
        <comment type="line" pos:line="211" pos:column="9">/// has not been properly set.&lt;/exception&gt;</comment>
        <function><type><specifier pos:line="212" pos:column="9">public</specifier> <name pos:line="212" pos:column="16">void</name></type> <name pos:line="212" pos:column="21">Capture</name><parameter_list pos:line="212" pos:column="28">(<param><decl><type><name pos:line="212" pos:column="29">int</name></type> <name pos:line="212" pos:column="33">x</name></decl></param><op:operator pos:line="212" pos:column="34">,</op:operator> <param><decl><type><name pos:line="212" pos:column="36">int</name></type> <name pos:line="212" pos:column="40">y</name></decl></param><op:operator pos:line="212" pos:column="41">,</op:operator> <param><decl><type><name pos:line="212" pos:column="43">int</name></type> <name pos:line="212" pos:column="47">width</name></decl></param><op:operator pos:line="212" pos:column="52">,</op:operator> <param><decl><type><name pos:line="212" pos:column="54">int</name></type> <name pos:line="212" pos:column="58">height</name></decl></param>)</parameter_list>
        <block pos:line="213" pos:column="9">{
            <expr_stmt><expr><call><name pos:line="214" pos:column="13">Capture</name><argument_list pos:line="214" pos:column="20">(<argument><expr><name pos:line="214" pos:column="21">x</name></expr></argument><op:operator pos:line="214" pos:column="22">,</op:operator> <argument><expr><name pos:line="214" pos:column="24">y</name></expr></argument><op:operator pos:line="214" pos:column="25">,</op:operator> <argument><expr><name pos:line="214" pos:column="27">width</name></expr></argument><op:operator pos:line="214" pos:column="32">,</op:operator> <argument><expr><name pos:line="214" pos:column="34">height</name></expr></argument><op:operator pos:line="214" pos:column="40">,</op:operator> <argument><expr><lit:literal type="number" pos:line="214" pos:column="42">0.0</lit:literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        }</block></function>

        <comment type="line" pos:line="217" pos:column="9">/// &lt;summary&gt;</comment>
        <comment type="line" pos:line="218" pos:column="9">/// Captures a screenshot and raises events that notify the loaded plugin.</comment>
        <comment type="line" pos:line="219" pos:column="9">/// &lt;/summary&gt;</comment>
        <comment type="line" pos:line="220" pos:column="9">/// &lt;param name="captureArea"&gt;&lt;/param&gt;</comment>
        <comment type="line" pos:line="221" pos:column="9">/// &lt;param name="maxThumbnailSize"&gt;A double representing the maximum thumbnail size.&lt;/param&gt;</comment>
        <comment type="line" pos:line="222" pos:column="9">/// &lt;exception cref="InvalidOperationException"&gt;Thrown when the &lt;see cref="ImageFormat"/&gt; </comment>
        <comment type="line" pos:line="223" pos:column="9">/// has not been properly set.&lt;/exception&gt;</comment>
        <function><type><specifier pos:line="224" pos:column="9">public</specifier> <name pos:line="224" pos:column="16">void</name></type> <name pos:line="224" pos:column="21">Capture</name><parameter_list pos:line="224" pos:column="28">(<param><decl><type><name pos:line="224" pos:column="29">Rectangle</name></type> <name pos:line="224" pos:column="39">captureArea</name></decl></param><op:operator pos:line="224" pos:column="50">,</op:operator> <param><decl><type><name pos:line="224" pos:column="52">double</name></type> <name pos:line="224" pos:column="59">maxThumbnailSize</name></decl></param>)</parameter_list>
        <block pos:line="225" pos:column="9">{
            <expr_stmt><expr><call><name pos:line="226" pos:column="13">Capture</name><argument_list pos:line="226" pos:column="20">(<argument><expr><name><name pos:line="226" pos:column="21">captureArea</name><op:operator pos:line="226" pos:column="32">.</op:operator><name pos:line="226" pos:column="33">X</name></name></expr></argument><op:operator pos:line="226" pos:column="34">,</op:operator> <argument><expr><name><name pos:line="226" pos:column="36">captureArea</name><op:operator pos:line="226" pos:column="47">.</op:operator><name pos:line="226" pos:column="48">Y</name></name></expr></argument><op:operator pos:line="226" pos:column="49">,</op:operator> <argument><expr><name><name pos:line="226" pos:column="51">captureArea</name><op:operator pos:line="226" pos:column="62">.</op:operator><name pos:line="226" pos:column="63">Width</name></name></expr></argument><op:operator pos:line="226" pos:column="68">,</op:operator> <argument><expr><name><name pos:line="226" pos:column="70">captureArea</name><op:operator pos:line="226" pos:column="81">.</op:operator><name pos:line="226" pos:column="82">Height</name></name></expr></argument><op:operator pos:line="226" pos:column="88">,</op:operator> <argument><expr><name pos:line="226" pos:column="90">maxThumbnailSize</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        }</block></function>

        <comment type="line" pos:line="229" pos:column="9">/// &lt;summary&gt;</comment>
        <comment type="line" pos:line="230" pos:column="9">/// Captures a screenshot and raises events that notify the loaded plugin.</comment>
        <comment type="line" pos:line="231" pos:column="9">/// &lt;/summary&gt;</comment>
        <comment type="line" pos:line="232" pos:column="9">/// &lt;param name="location"&gt;&lt;/param&gt;</comment>
        <comment type="line" pos:line="233" pos:column="9">/// &lt;param name="size"&gt;&lt;/param&gt;</comment>
        <comment type="line" pos:line="234" pos:column="9">/// &lt;param name="maxThumbnailSize"&gt;A double representing the maximum thumbnail size.&lt;/param&gt;</comment>
        <comment type="line" pos:line="235" pos:column="9">/// &lt;exception cref="InvalidOperationException"&gt;Thrown when the &lt;see cref="ImageFormat"/&gt; </comment>
        <comment type="line" pos:line="236" pos:column="9">/// has not been properly set.&lt;/exception&gt;</comment>
        <function><type><specifier pos:line="237" pos:column="9">public</specifier> <name pos:line="237" pos:column="16">void</name></type> <name pos:line="237" pos:column="21">Capture</name><parameter_list pos:line="237" pos:column="28">(<param><decl><type><name pos:line="237" pos:column="29">Point</name></type> <name pos:line="237" pos:column="35">location</name></decl></param><op:operator pos:line="237" pos:column="43">,</op:operator> <param><decl><type><name pos:line="237" pos:column="45">Size</name></type> <name pos:line="237" pos:column="50">size</name></decl></param><op:operator pos:line="237" pos:column="54">,</op:operator> <param><decl><type><name pos:line="237" pos:column="56">double</name></type> <name pos:line="237" pos:column="63">maxThumbnailSize</name></decl></param>)</parameter_list>
        <block pos:line="238" pos:column="9">{
            <expr_stmt><expr><call><name pos:line="239" pos:column="13">Capture</name><argument_list pos:line="239" pos:column="20">(<argument><expr><name><name pos:line="239" pos:column="21">location</name><op:operator pos:line="239" pos:column="29">.</op:operator><name pos:line="239" pos:column="30">X</name></name></expr></argument><op:operator pos:line="239" pos:column="31">,</op:operator> <argument><expr><name><name pos:line="239" pos:column="33">location</name><op:operator pos:line="239" pos:column="41">.</op:operator><name pos:line="239" pos:column="42">Y</name></name></expr></argument><op:operator pos:line="239" pos:column="43">,</op:operator> <argument><expr><name><name pos:line="239" pos:column="45">size</name><op:operator pos:line="239" pos:column="49">.</op:operator><name pos:line="239" pos:column="50">Width</name></name></expr></argument><op:operator pos:line="239" pos:column="55">,</op:operator> <argument><expr><name><name pos:line="239" pos:column="57">size</name><op:operator pos:line="239" pos:column="61">.</op:operator><name pos:line="239" pos:column="62">Height</name></name></expr></argument><op:operator pos:line="239" pos:column="68">,</op:operator> <argument><expr><name pos:line="239" pos:column="70">maxThumbnailSize</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        }</block></function>

        <comment type="line" pos:line="242" pos:column="9">/// &lt;summary&gt;</comment>
        <comment type="line" pos:line="243" pos:column="9">/// Captures a screenshot and raises events that notify the loaded plugin.</comment>
        <comment type="line" pos:line="244" pos:column="9">/// &lt;/summary&gt;</comment>
        <comment type="line" pos:line="245" pos:column="9">/// &lt;param name="x"&gt;&lt;/param&gt;</comment>
        <comment type="line" pos:line="246" pos:column="9">/// &lt;param name="y"&gt;&lt;/param&gt;</comment>
        <comment type="line" pos:line="247" pos:column="9">/// &lt;param name="width"&gt;&lt;/param&gt;</comment>
        <comment type="line" pos:line="248" pos:column="9">/// &lt;param name="height"&gt;&lt;/param&gt;</comment>
        <comment type="line" pos:line="249" pos:column="9">/// &lt;param name="maxThumbnailSize"&gt;A double representing the maximum thumbnail size.&lt;/param&gt;</comment>
        <comment type="line" pos:line="250" pos:column="9">/// &lt;exception cref="InvalidOperationException"&gt;Thrown when the &lt;see cref="ImageFormat"/&gt; </comment>
        <comment type="line" pos:line="251" pos:column="9">/// has not been properly set.&lt;/exception&gt;</comment>
        <function><type><specifier pos:line="252" pos:column="9">public</specifier> <name pos:line="252" pos:column="16">void</name></type> <name pos:line="252" pos:column="21">Capture</name><parameter_list pos:line="252" pos:column="28">(<param><decl><type><name pos:line="252" pos:column="29">int</name></type> <name pos:line="252" pos:column="33">x</name></decl></param><op:operator pos:line="252" pos:column="34">,</op:operator> <param><decl><type><name pos:line="252" pos:column="36">int</name></type> <name pos:line="252" pos:column="40">y</name></decl></param><op:operator pos:line="252" pos:column="41">,</op:operator> <param><decl><type><name pos:line="252" pos:column="43">int</name></type> <name pos:line="252" pos:column="47">width</name></decl></param><op:operator pos:line="252" pos:column="52">,</op:operator> <param><decl><type><name pos:line="252" pos:column="54">int</name></type> <name pos:line="252" pos:column="58">height</name></decl></param><op:operator pos:line="252" pos:column="64">,</op:operator> <param><decl><type><name pos:line="252" pos:column="66">double</name></type> <name pos:line="252" pos:column="73">maxThumbnailSize</name></decl></param>)</parameter_list>
        <block pos:line="253" pos:column="9">{
            <if pos:line="254" pos:column="13">if <condition pos:line="254" pos:column="16">(<expr><name pos:line="254" pos:column="17">ImageFormat</name> <op:operator pos:line="254" pos:column="29">==</op:operator> <name pos:line="254" pos:column="32">null</name></expr>)</condition><then pos:line="254" pos:column="37">
                <throw pos:line="255" pos:column="17">throw <expr><op:operator pos:line="255" pos:column="23">new</op:operator> <call><name pos:line="255" pos:column="27">InvalidOperationException</name><argument_list pos:line="255" pos:column="52">(<argument><expr><name><name pos:line="255" pos:column="53">SR</name><op:operator pos:line="255" pos:column="55">.</op:operator><name pos:line="255" pos:column="56">ExceptionImageFormatNull</name></name></expr></argument>)</argument_list></call></expr>;</throw></then></if>

            <expr_stmt><expr><name pos:line="257" pos:column="13">captureRectangle</name> <op:operator pos:line="257" pos:column="30">=</op:operator> <op:operator pos:line="257" pos:column="32">new</op:operator> <call><name pos:line="257" pos:column="36">Rectangle</name><argument_list pos:line="257" pos:column="45">(<argument><expr><name pos:line="257" pos:column="46">x</name></expr></argument><op:operator pos:line="257" pos:column="47">,</op:operator> <argument><expr><name pos:line="257" pos:column="49">y</name></expr></argument><op:operator pos:line="257" pos:column="50">,</op:operator> <argument><expr><name pos:line="257" pos:column="52">width</name></expr></argument><op:operator pos:line="257" pos:column="57">,</op:operator> <argument><expr><name pos:line="257" pos:column="59">height</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name pos:line="258" pos:column="13">OnImageCapturing</name><argument_list pos:line="258" pos:column="29">(<argument><expr><op:operator pos:line="258" pos:column="30">new</op:operator> <call><name pos:line="258" pos:column="34">ImageCapturingEventArgs</name><argument_list pos:line="258" pos:column="57">()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <using pos:line="259" pos:column="13">using (Image image = <name><name pos:line="259" pos:column="34">NativeMethods</name><op:operator pos:line="259" pos:column="47">.</op:operator><name pos:line="259" pos:column="48">GetDesktopBitmap</name></name><parameter_list pos:line="259" pos:column="64">(<param><decl><type><name pos:line="259" pos:column="65">x</name></type></decl></param><op:operator pos:line="259" pos:column="66">,</op:operator> <param><decl><type><name pos:line="259" pos:column="68">y</name></type></decl></param><op:operator pos:line="259" pos:column="69">,</op:operator> <param><decl><type><name pos:line="259" pos:column="71">width</name></type></decl></param><op:operator pos:line="259" pos:column="76">,</op:operator> <param><decl><type><name pos:line="259" pos:column="78">height</name></type></decl></param>)</parameter_list></using>)</block>
            <block pos:line="260" pos:column="13">{
                <decl_stmt><decl><type><name pos:line="261" pos:column="17">ImageCapturedEventArgs</name></type> <name pos:line="261" pos:column="40">imageCapturedEventArgs</name> =<init pos:line="261" pos:column="64"> <expr><call><name pos:line="261" pos:column="65">ProcessCapturedImage</name><argument_list pos:line="261" pos:column="85">(<argument><expr><name pos:line="261" pos:column="86">image</name></expr></argument><op:operator pos:line="261" pos:column="91">,</op:operator> <argument><expr><name pos:line="261" pos:column="93">maxThumbnailSize</name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
                <expr_stmt><expr><call><name pos:line="262" pos:column="17">OnImageCaptured</name><argument_list pos:line="262" pos:column="32">(<argument><expr><name pos:line="262" pos:column="33">imageCapturedEventArgs</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            }</block></function>
        }</block></class>

        <comment type="line" pos:line="266" pos:column="9">/// &lt;summary&gt;</comment>
        <comment type="line" pos:line="267" pos:column="9">/// Captures a screenshot and raises events that notify the loaded plugin.</comment>
        <comment type="line" pos:line="268" pos:column="9">/// &lt;/summary&gt;</comment>
        <comment type="line" pos:line="269" pos:column="9">/// &lt;exception cref="InvalidOperationException"&gt;Thrown when the &lt;see cref="ImageFormat"/&gt; </comment>
        <comment type="line" pos:line="270" pos:column="9">/// has not been properly set.&lt;/exception&gt;</comment>
        <function><type><specifier pos:line="271" pos:column="9">public</specifier> <name pos:line="271" pos:column="16">void</name></type> <name pos:line="271" pos:column="21">CaptureDesktop</name><parameter_list pos:line="271" pos:column="35">()</parameter_list>
        <block pos:line="272" pos:column="9">{
            <if pos:line="273" pos:column="13">if <condition pos:line="273" pos:column="16">(<expr><name pos:line="273" pos:column="17">ImageFormat</name> <op:operator pos:line="273" pos:column="29">==</op:operator> <name pos:line="273" pos:column="32">null</name></expr>)</condition><then pos:line="273" pos:column="37">
                <throw pos:line="274" pos:column="17">throw <expr><op:operator pos:line="274" pos:column="23">new</op:operator> <call><name pos:line="274" pos:column="27">InvalidOperationException</name><argument_list pos:line="274" pos:column="52">(<argument><expr><name><name pos:line="274" pos:column="53">SR</name><op:operator pos:line="274" pos:column="55">.</op:operator><name pos:line="274" pos:column="56">ExceptionImageFormatNull</name></name></expr></argument>)</argument_list></call></expr>;</throw></then></if>
            <expr_stmt><expr><call><name pos:line="275" pos:column="13">CaptureByHdc</name><argument_list pos:line="275" pos:column="25">(<argument><expr><call><name><name pos:line="275" pos:column="26">NativeMethods</name><op:operator pos:line="275" pos:column="39">.</op:operator><name pos:line="275" pos:column="40">FindWindow</name></name><argument_list pos:line="275" pos:column="50">(<argument><expr><name pos:line="275" pos:column="51">null</name></expr></argument><op:operator pos:line="275" pos:column="55">,</op:operator> <argument><expr><lit:literal type="string" pos:line="275" pos:column="57">"Program Manager"</lit:literal></expr></argument>)</argument_list></call></expr></argument><op:operator pos:line="275" pos:column="75">,</op:operator> <argument><expr><lit:literal type="boolean" pos:line="275" pos:column="77">false</lit:literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        }</block></function>

        <comment type="line" pos:line="278" pos:column="9">/// &lt;summary&gt;</comment>
        <comment type="line" pos:line="279" pos:column="9">/// Captures a screenshot and raises events that notify the loaded plugin.</comment>
        <comment type="line" pos:line="280" pos:column="9">/// &lt;/summary&gt;</comment>
        <comment type="line" pos:line="281" pos:column="9">/// &lt;exception cref="InvalidOperationException"&gt;Thrown when the &lt;see cref="ImageFormat"/&gt; </comment>
        <comment type="line" pos:line="282" pos:column="9">/// has not been properly set.&lt;/exception&gt;</comment>
        <function><type><specifier pos:line="283" pos:column="9">public</specifier> <name pos:line="283" pos:column="16">void</name></type> <name pos:line="283" pos:column="21">CaptureForegroundForm</name><parameter_list pos:line="283" pos:column="42">()</parameter_list>
        <block pos:line="284" pos:column="9">{
            <if pos:line="285" pos:column="13">if <condition pos:line="285" pos:column="16">(<expr><name pos:line="285" pos:column="17">ImageFormat</name> <op:operator pos:line="285" pos:column="29">==</op:operator> <name pos:line="285" pos:column="32">null</name></expr>)</condition><then pos:line="285" pos:column="37">
                <throw pos:line="286" pos:column="17">throw <expr><op:operator pos:line="286" pos:column="23">new</op:operator> <call><name pos:line="286" pos:column="27">InvalidOperationException</name><argument_list pos:line="286" pos:column="52">(<argument><expr><name><name pos:line="286" pos:column="53">SR</name><op:operator pos:line="286" pos:column="55">.</op:operator><name pos:line="286" pos:column="56">ExceptionImageFormatNull</name></name></expr></argument>)</argument_list></call></expr>;</throw></then></if>
            <expr_stmt><expr><call><name pos:line="287" pos:column="13">CaptureByHdc</name><argument_list pos:line="287" pos:column="25">(<argument><expr><call><name><name pos:line="287" pos:column="26">NativeMethods</name><op:operator pos:line="287" pos:column="39">.</op:operator><name pos:line="287" pos:column="40">GetForegroundWindow</name></name><argument_list pos:line="287" pos:column="59">()</argument_list></call></expr></argument><op:operator pos:line="287" pos:column="61">,</op:operator> <argument><expr><name><name pos:line="287" pos:column="63">Configuration</name><op:operator pos:line="287" pos:column="76">.</op:operator><name pos:line="287" pos:column="77">Current</name><op:operator pos:line="287" pos:column="84">.</op:operator><name pos:line="287" pos:column="85">ColorNonFormArea</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        }</block></function>

        <comment type="line" pos:line="290" pos:column="9">/// &lt;summary&gt;</comment>
        <comment type="line" pos:line="291" pos:column="9">/// Captures a screenshot and raises events that notify the loaded plugin.</comment>
        <comment type="line" pos:line="292" pos:column="9">/// &lt;/summary&gt;</comment>
        <comment type="line" pos:line="293" pos:column="9">/// &lt;exception cref="InvalidOperationException"&gt;Thrown when the &lt;see cref="ImageFormat"/&gt; </comment>
        <comment type="line" pos:line="294" pos:column="9">/// has not been properly set.&lt;/exception&gt;</comment>
        <function><type><specifier pos:line="295" pos:column="9">public</specifier> <name pos:line="295" pos:column="16">void</name></type> <name pos:line="295" pos:column="21">CaptureWindowAtPoint</name><parameter_list pos:line="295" pos:column="41">(<param><decl><type><name pos:line="295" pos:column="42">Point</name></type> <name pos:line="295" pos:column="48">windowLocation</name></decl></param>)</parameter_list>
        <block pos:line="296" pos:column="9">{
            <if pos:line="297" pos:column="13">if <condition pos:line="297" pos:column="16">(<expr><name pos:line="297" pos:column="17">ImageFormat</name> <op:operator pos:line="297" pos:column="29">==</op:operator> <name pos:line="297" pos:column="32">null</name></expr>)</condition><then pos:line="297" pos:column="37">
                <throw pos:line="298" pos:column="17">throw <expr><op:operator pos:line="298" pos:column="23">new</op:operator> <call><name pos:line="298" pos:column="27">InvalidOperationException</name><argument_list pos:line="298" pos:column="52">(<argument><expr><name><name pos:line="298" pos:column="53">SR</name><op:operator pos:line="298" pos:column="55">.</op:operator><name pos:line="298" pos:column="56">ExceptionImageFormatNull</name></name></expr></argument>)</argument_list></call></expr>;</throw></then></if>
            <expr_stmt><expr><call><name pos:line="299" pos:column="13">CaptureByHdc</name><argument_list pos:line="299" pos:column="25">(<argument><expr><call><name><name pos:line="299" pos:column="26">NativeMethods</name><op:operator pos:line="299" pos:column="39">.</op:operator><name pos:line="299" pos:column="40">WindowFromPoint</name></name><argument_list pos:line="299" pos:column="55">(<argument><expr><op:operator pos:line="299" pos:column="56">(</op:operator><name><name pos:line="299" pos:column="57">NativeMethods</name><op:operator pos:line="299" pos:column="70">.</op:operator><name pos:line="299" pos:column="71">POINT</name></name><op:operator pos:line="299" pos:column="76">)</op:operator><name pos:line="299" pos:column="77">windowLocation</name></expr></argument>)</argument_list></call></expr></argument><op:operator pos:line="299" pos:column="92">,</op:operator> <argument><expr><name><name pos:line="299" pos:column="94">Configuration</name><op:operator pos:line="299" pos:column="107">.</op:operator><name pos:line="299" pos:column="108">Current</name><op:operator pos:line="299" pos:column="115">.</op:operator><name pos:line="299" pos:column="116">ColorNonFormArea</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        }</block></function>

        <function><type><specifier pos:line="302" pos:column="9">private</specifier> <name pos:line="302" pos:column="17">void</name></type> <name pos:line="302" pos:column="22">CaptureByHdc</name><parameter_list pos:line="302" pos:column="34">(<param><decl><type><name pos:line="302" pos:column="35">IntPtr</name></type> <name pos:line="302" pos:column="42">hdc</name></decl></param><op:operator pos:line="302" pos:column="45">,</op:operator> <param><decl><type><name pos:line="302" pos:column="47">bool</name></type> <name pos:line="302" pos:column="52">cropAndColor</name></decl></param>)</parameter_list>
        <block pos:line="303" pos:column="9">{
            <expr_stmt><expr><call><name pos:line="304" pos:column="13">OnImageCapturing</name><argument_list pos:line="304" pos:column="29">(<argument><expr><op:operator pos:line="304" pos:column="30">new</op:operator> <call><name pos:line="304" pos:column="34">ImageCapturingEventArgs</name><argument_list pos:line="304" pos:column="57">()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <using pos:line="305" pos:column="13">using (Image image = <name><name pos:line="305" pos:column="34">NativeMethods</name><op:operator pos:line="305" pos:column="47">.</op:operator><name pos:line="305" pos:column="48">GetDesktopBitmap</name></name><parameter_list pos:line="305" pos:column="64">(<param><decl><type><name pos:line="305" pos:column="65">hdc</name></type></decl></param><op:operator pos:line="305" pos:column="68">,</op:operator> <param><decl><type><name pos:line="305" pos:column="70">cropAndColor</name></type></decl></param><op:operator pos:line="305" pos:column="82">,</op:operator> <param><decl/></param></parameter_list>Color.<specifier pos:line="305" pos:column="90">FromArgb</specifier><parameter_list pos:line="305" pos:column="98">(<param><decl><type><name><name pos:line="305" pos:column="99">Configuration</name><op:operator pos:line="305" pos:column="112">.</op:operator><name pos:line="305" pos:column="113">Current</name><op:operator pos:line="305" pos:column="120">.</op:operator><name pos:line="305" pos:column="121">NonFormAreaColorArgb</name></name></type></decl></param>)</parameter_list></using>)</block></function>)</block>
            <block pos:line="306" pos:column="13">{
                <if pos:line="307" pos:column="17">if <condition pos:line="307" pos:column="20">(<expr><name><name pos:line="307" pos:column="21">Configuration</name><op:operator pos:line="307" pos:column="34">.</op:operator><name pos:line="307" pos:column="35">Current</name><op:operator pos:line="307" pos:column="42">.</op:operator><name pos:line="307" pos:column="43">LeavePrintScreenOnClipboard</name></name></expr>)</condition><then pos:line="307" pos:column="71">
                    <expr_stmt><expr><call><name><name pos:line="308" pos:column="21">Clipboard</name><op:operator pos:line="308" pos:column="30">.</op:operator><name pos:line="308" pos:column="31">SetImage</name></name><argument_list pos:line="308" pos:column="39">(<argument><expr><name pos:line="308" pos:column="40">image</name></expr></argument>)</argument_list></call></expr>;</expr_stmt></then></if>

                <decl_stmt><decl><type><name pos:line="310" pos:column="17">ImageCapturedEventArgs</name></type> <name pos:line="310" pos:column="40">imageCapturedEventArgs</name> =<init pos:line="310" pos:column="64"> <expr><call><name pos:line="310" pos:column="65">ProcessCapturedImage</name><argument_list pos:line="310" pos:column="85">(<argument><expr><name pos:line="310" pos:column="86">image</name></expr></argument><op:operator pos:line="310" pos:column="91">,</op:operator> <argument><expr><lit:literal type="number" pos:line="310" pos:column="93">0.0</lit:literal></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
                <expr_stmt><expr><call><name pos:line="311" pos:column="17">OnImageCaptured</name><argument_list pos:line="311" pos:column="32">(<argument><expr><name pos:line="311" pos:column="33">imageCapturedEventArgs</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            }</block></namespace>
        }

        <function><type><specifier pos:line="315" pos:column="9">private</specifier> <name pos:line="315" pos:column="17">ImageCapturedEventArgs</name></type> <name pos:line="315" pos:column="40">ProcessCapturedImage</name><parameter_list pos:line="315" pos:column="60">(<param><decl><type><name pos:line="315" pos:column="61">Image</name></type> <name pos:line="315" pos:column="67">image</name></decl></param><op:operator pos:line="315" pos:column="72">,</op:operator> <param><decl><type><name pos:line="315" pos:column="74">double</name></type> <name pos:line="315" pos:column="81">maxThumbnailSize</name></decl></param>)</parameter_list>
        <block pos:line="316" pos:column="9">{
            <decl_stmt><decl><type><name pos:line="317" pos:column="13">ImageCapturedEventArgs</name></type> <name pos:line="317" pos:column="36">imageCapturedEventArgs</name> =<init pos:line="317" pos:column="60"> <expr><op:operator pos:line="317" pos:column="61">new</op:operator> <call><name pos:line="317" pos:column="65">ImageCapturedEventArgs</name><argument_list pos:line="317" pos:column="87">()</argument_list></call></expr></init></decl>;</decl_stmt>
            <expr_stmt><expr><name><name pos:line="318" pos:column="13">imageCapturedEventArgs</name><op:operator pos:line="318" pos:column="35">.</op:operator><name pos:line="318" pos:column="36">ImageNames</name></name> <op:operator pos:line="318" pos:column="47">=</op:operator></expr></expr_stmt> <template pos:line="318" pos:column="49">template.<param><type/><name pos:line="318" pos:column="58">Parse</name><argument_list pos:line="318" pos:column="63">(<argument><expr><name><name pos:line="318" pos:column="64">ImageFormat</name><op:operator pos:line="318" pos:column="75">.</op:operator><name pos:line="318" pos:column="76">Extension</name></name></expr></argument>)</argument_list></param><empty_stmt pos:line="318" pos:column="86">;</empty_stmt></template>
            <expr_stmt><expr><name><name pos:line="319" pos:column="13">imageCapturedEventArgs</name><op:operator pos:line="319" pos:column="35">.</op:operator><name pos:line="319" pos:column="36">FullSizeImage</name></name> <op:operator pos:line="319" pos:column="50">=</op:operator> <name pos:line="319" pos:column="52">image</name></expr>;</expr_stmt>
            <expr_stmt><expr><name><name pos:line="320" pos:column="13">imageCapturedEventArgs</name><op:operator pos:line="320" pos:column="35">.</op:operator><name pos:line="320" pos:column="36">IsThumbnailed</name></name> <op:operator pos:line="320" pos:column="50">=</op:operator> <op:operator pos:line="320" pos:column="52">(</op:operator><name pos:line="320" pos:column="53">maxThumbnailSize</name> <op:operator pos:line="320" pos:column="70">&gt;</op:operator> <lit:literal type="number" pos:line="320" pos:column="72">0.0</lit:literal><op:operator pos:line="320" pos:column="75">)</op:operator></expr>;</expr_stmt>
            <if pos:line="321" pos:column="13">if <condition pos:line="321" pos:column="16">(<expr><name><name pos:line="321" pos:column="17">imageCapturedEventArgs</name><op:operator pos:line="321" pos:column="39">.</op:operator><name pos:line="321" pos:column="40">IsThumbnailed</name></name></expr>)</condition><then pos:line="321" pos:column="54">
                <expr_stmt><expr><name><name pos:line="322" pos:column="17">imageCapturedEventArgs</name><op:operator pos:line="322" pos:column="39">.</op:operator><name pos:line="322" pos:column="40">ThumbnailImage</name></name> <op:operator pos:line="322" pos:column="55">=</op:operator> <call><name pos:line="322" pos:column="57">CreateThumbnailImage</name><argument_list pos:line="322" pos:column="77">(<argument><expr><name pos:line="322" pos:column="78">image</name></expr></argument><op:operator pos:line="322" pos:column="83">,</op:operator> <argument><expr><name pos:line="322" pos:column="85">maxThumbnailSize</name></expr></argument>)</argument_list></call></expr>;</expr_stmt></then></if>
            <expr_stmt><expr><name pos:line="323" pos:column="13">lastImageCaptured</name> <op:operator pos:line="323" pos:column="31">=</op:operator> <name><name pos:line="323" pos:column="33">imageCapturedEventArgs</name><op:operator pos:line="323" pos:column="55">.</op:operator><name pos:line="323" pos:column="56">ImageNames</name><op:operator pos:line="323" pos:column="66">.</op:operator><name pos:line="323" pos:column="67">FullSize</name></name></expr>;</expr_stmt>
            <return pos:line="324" pos:column="13">return <expr><name pos:line="324" pos:column="20">imageCapturedEventArgs</name></expr>;</return>
        }</block></function>



        <comment type="line" pos:line="329" pos:column="9">/// &lt;summary&gt;</comment>
        <comment type="line" pos:line="330" pos:column="9">/// Retrieves another cropped image once a capture has been initialized.</comment>
        <comment type="line" pos:line="331" pos:column="9">/// &lt;/summary&gt;</comment>
        <comment type="line" pos:line="332" pos:column="9">/// &lt;param name="imageHandler"&gt;An &lt;see cref="ImageHandler"/&gt; delegate containing the </comment>
        <comment type="line" pos:line="333" pos:column="9">/// method to call once the image is retrieved.&lt;/param&gt;</comment>
        <function><type><name pos:line="334" pos:column="9">void</name></type> <name><name pos:line="334" pos:column="14">IPersistableOutput</name><op:operator pos:line="334" pos:column="32">.</op:operator><name pos:line="334" pos:column="33">FetchCapture</name></name><parameter_list pos:line="334" pos:column="45">(<param><decl><type><name pos:line="334" pos:column="46">ImageHandler</name></type> <name pos:line="334" pos:column="59">imageHandler</name></decl></param>)</parameter_list>
        <block pos:line="335" pos:column="9">{
            <using pos:line="336" pos:column="13">using (Image image = <name><name pos:line="336" pos:column="34">NativeMethods</name><op:operator pos:line="336" pos:column="47">.</op:operator><name pos:line="336" pos:column="48">GetDesktopBitmap</name></name><parameter_list pos:line="336" pos:column="64">(<param><decl><type><name pos:line="336" pos:column="65">captureRectangle</name></type></decl></param>)</parameter_list></using>)</block>
                <specifier pos:line="337" pos:column="17">imageHandler</specifier><parameter_list pos:line="337" pos:column="29">(<param><decl><type><name pos:line="337" pos:column="30">image</name></type></decl></param>)</parameter_list>;</function>
        }

        <comment type="line" pos:line="340" pos:column="9">/// &lt;summary&gt;</comment>
        <comment type="line" pos:line="341" pos:column="9">/// Retrieves a stream for saving an image.</comment>
        <comment type="line" pos:line="342" pos:column="9">/// &lt;/summary&gt;</comment>
        <comment type="line" pos:line="343" pos:column="9">/// &lt;param name="streamHandler"&gt;A &lt;see cref="StreamHandler"/&gt;Delegate containg the method to call </comment>
        <comment type="line" pos:line="344" pos:column="9">/// when the stream is retrieved and the image to pass to the callback.&lt;/param&gt;</comment>
        <comment type="line" pos:line="345" pos:column="9">/// &lt;param name="fileName"&gt;The image's file name.&lt;/param&gt;</comment>
        <comment type="line" pos:line="346" pos:column="9">/// &lt;param name="image"&gt;The image to return to the callback method.&lt;/param&gt;</comment>
        <function><type><specifier pos:line="347" pos:column="9">public</specifier> <name pos:line="347" pos:column="16">void</name></type> <name pos:line="347" pos:column="21">FetchOutputStream</name><parameter_list pos:line="347" pos:column="38">(<param><decl><type><name pos:line="347" pos:column="39">StreamHandler</name></type> <name pos:line="347" pos:column="53">streamHandler</name></decl></param><op:operator pos:line="347" pos:column="66">,</op:operator> <param><decl><type><name pos:line="347" pos:column="68">string</name></type> <name pos:line="347" pos:column="75">fileName</name></decl></param><op:operator pos:line="347" pos:column="83">,</op:operator> <param><decl><type><name pos:line="347" pos:column="85">Image</name></type> <name pos:line="347" pos:column="91">image</name></decl></param>)</parameter_list>
        <block pos:line="348" pos:column="9">{
            <if pos:line="349" pos:column="13">if <condition pos:line="349" pos:column="16">(<expr><name pos:line="349" pos:column="17">streamHandler</name> <op:operator pos:line="349" pos:column="31">==</op:operator> <name pos:line="349" pos:column="34">null</name></expr>)</condition><then pos:line="349" pos:column="39">
                <throw pos:line="350" pos:column="17">throw <expr><op:operator pos:line="350" pos:column="23">new</op:operator> <call><name pos:line="350" pos:column="27">ArgumentNullException</name><argument_list pos:line="350" pos:column="48">(<argument><expr><lit:literal type="string" pos:line="350" pos:column="49">"streamHandler"</lit:literal></expr></argument>)</argument_list></call></expr>;</throw></then></if>

            <if pos:line="352" pos:column="13">if <condition pos:line="352" pos:column="16">(<expr><name pos:line="352" pos:column="17">fileName</name> <op:operator pos:line="352" pos:column="26">==</op:operator> <name pos:line="352" pos:column="29">null</name></expr>)</condition><then pos:line="352" pos:column="34">
                <throw pos:line="353" pos:column="17">throw <expr><op:operator pos:line="353" pos:column="23">new</op:operator> <call><name pos:line="353" pos:column="27">ArgumentNullException</name><argument_list pos:line="353" pos:column="48">(<argument><expr><lit:literal type="string" pos:line="353" pos:column="49">"fileName"</lit:literal></expr></argument>)</argument_list></call></expr>;</throw></then></if>

            <if pos:line="355" pos:column="13">if <condition pos:line="355" pos:column="16">(<expr><name pos:line="355" pos:column="17">image</name> <op:operator pos:line="355" pos:column="23">==</op:operator> <name pos:line="355" pos:column="26">null</name></expr>)</condition><then pos:line="355" pos:column="31">
                <throw pos:line="356" pos:column="17">throw <expr><op:operator pos:line="356" pos:column="23">new</op:operator> <call><name pos:line="356" pos:column="27">ArgumentNullException</name><argument_list pos:line="356" pos:column="48">(<argument><expr><lit:literal type="string" pos:line="356" pos:column="49">"image"</lit:literal></expr></argument>)</argument_list></call></expr>;</throw></then></if>

            <using pos:line="358" pos:column="13">using (FileStream stream = <name><name pos:line="358" pos:column="40">File</name><op:operator pos:line="358" pos:column="44">.</op:operator><name pos:line="358" pos:column="45">Open</name></name><parameter_list pos:line="358" pos:column="49">(<param><decl><type><name pos:line="358" pos:column="50">fileName</name></type></decl></param><op:operator pos:line="358" pos:column="58">,</op:operator> <param><decl><type><name><name pos:line="358" pos:column="60">FileMode</name><op:operator pos:line="358" pos:column="68">.</op:operator><name pos:line="358" pos:column="69">Create</name></name></type></decl></param>)</parameter_list></using>)</block>
                <specifier pos:line="359" pos:column="17">streamHandler</specifier><parameter_list pos:line="359" pos:column="30">(<param><decl><type><name pos:line="359" pos:column="31">stream</name></type></decl></param><op:operator pos:line="359" pos:column="37">,</op:operator> <param><decl><type><name pos:line="359" pos:column="39">image</name></type></decl></param>)</parameter_list>;</function>
        }

        <function><type><specifier pos:line="362" pos:column="9">private</specifier> <specifier pos:line="362" pos:column="17">static</specifier> <name pos:line="362" pos:column="24">Image</name></type> <name pos:line="362" pos:column="30">CreateThumbnailImage</name><parameter_list pos:line="362" pos:column="50">(<param><decl><type><name pos:line="362" pos:column="51">Image</name></type> <name pos:line="362" pos:column="57">image</name></decl></param><op:operator pos:line="362" pos:column="62">,</op:operator> <param><decl><type><name pos:line="362" pos:column="64">double</name></type> <name pos:line="362" pos:column="71">maxSize</name></decl></param>)</parameter_list>
        <block pos:line="363" pos:column="9">{
            <if pos:line="364" pos:column="13">if <condition pos:line="364" pos:column="16">(<expr><name pos:line="364" pos:column="17">maxSize</name> <op:operator pos:line="364" pos:column="25">&lt;</op:operator> <lit:literal type="number" pos:line="364" pos:column="27">0</lit:literal> <op:operator pos:line="364" pos:column="29">||</op:operator> <name pos:line="364" pos:column="32">maxSize</name> <op:operator pos:line="364" pos:column="40">&gt;</op:operator> <name><name pos:line="364" pos:column="42">Int32</name><op:operator pos:line="364" pos:column="47">.</op:operator><name pos:line="364" pos:column="48">MaxValue</name></name></expr>)</condition><then pos:line="364" pos:column="57">
                <throw pos:line="365" pos:column="17">throw <expr><op:operator pos:line="365" pos:column="23">new</op:operator> <call><name pos:line="365" pos:column="27">ArgumentOutOfRangeException</name><argument_list pos:line="365" pos:column="54">(
                        <argument><expr><lit:literal type="string" pos:line="366" pos:column="25">"maxSize"</lit:literal></expr></argument><op:operator pos:line="366" pos:column="34">,</op:operator>
                        <argument><expr><name pos:line="367" pos:column="25">maxSize</name></expr></argument><op:operator pos:line="367" pos:column="32">,</op:operator>
                        <argument><expr><name><name pos:line="368" pos:column="25">SR</name><op:operator pos:line="368" pos:column="27">.</op:operator><name pos:line="368" pos:column="28">ExeptionThumbnailSizeOutOfRange</name></name></expr></argument>)</argument_list></call></expr>;</throw></then></if>

            <decl_stmt><decl><type><name pos:line="370" pos:column="13">double</name></type> <name pos:line="370" pos:column="20">ratio</name></decl>;</decl_stmt>
            <if pos:line="371" pos:column="13">if <condition pos:line="371" pos:column="16">(<expr><name><name pos:line="371" pos:column="17">image</name><op:operator pos:line="371" pos:column="22">.</op:operator><name pos:line="371" pos:column="23">Height</name></name> <op:operator pos:line="371" pos:column="30">&gt;</op:operator> <name><name pos:line="371" pos:column="32">image</name><op:operator pos:line="371" pos:column="37">.</op:operator><name pos:line="371" pos:column="38">Width</name></name></expr>)</condition><then pos:line="371" pos:column="44">
                <expr_stmt><expr><name pos:line="372" pos:column="17">ratio</name> <op:operator pos:line="372" pos:column="23">=</op:operator> <name><name pos:line="372" pos:column="25">image</name><op:operator pos:line="372" pos:column="30">.</op:operator><name pos:line="372" pos:column="31">Height</name></name> <op:operator pos:line="372" pos:column="38">/</op:operator> <name pos:line="372" pos:column="40">maxSize</name></expr>;</expr_stmt></then>
            <else pos:line="373" pos:column="13">else
                <expr_stmt><expr><name pos:line="374" pos:column="17">ratio</name> <op:operator pos:line="374" pos:column="23">=</op:operator> <name><name pos:line="374" pos:column="25">image</name><op:operator pos:line="374" pos:column="30">.</op:operator><name pos:line="374" pos:column="31">Width</name></name> <op:operator pos:line="374" pos:column="37">/</op:operator> <name pos:line="374" pos:column="39">maxSize</name></expr>;</expr_stmt></else></if>

            <decl_stmt><decl><type><name pos:line="376" pos:column="13">int</name></type> <name pos:line="376" pos:column="17">newWidth</name> =<init pos:line="376" pos:column="27"> <expr><call><name><name pos:line="376" pos:column="28">Convert</name><op:operator pos:line="376" pos:column="35">.</op:operator><name pos:line="376" pos:column="36">ToInt32</name></name><argument_list pos:line="376" pos:column="43">(<argument><expr><name><name pos:line="376" pos:column="44">image</name><op:operator pos:line="376" pos:column="49">.</op:operator><name pos:line="376" pos:column="50">Width</name></name> <op:operator pos:line="376" pos:column="56">/</op:operator> <name pos:line="376" pos:column="58">ratio</name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
            <decl_stmt><decl><type><name pos:line="377" pos:column="13">int</name></type> <name pos:line="377" pos:column="17">newHeight</name> =<init pos:line="377" pos:column="28"> <expr><call><name><name pos:line="377" pos:column="29">Convert</name><op:operator pos:line="377" pos:column="36">.</op:operator><name pos:line="377" pos:column="37">ToInt32</name></name><argument_list pos:line="377" pos:column="44">(<argument><expr><name><name pos:line="377" pos:column="45">image</name><op:operator pos:line="377" pos:column="50">.</op:operator><name pos:line="377" pos:column="51">Height</name></name> <op:operator pos:line="377" pos:column="58">/</op:operator> <name pos:line="377" pos:column="60">ratio</name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>

            <decl_stmt><decl><type><name pos:line="379" pos:column="13">IntPtr</name></type> <name pos:line="379" pos:column="20">ip</name> =<init pos:line="379" pos:column="24"> <expr><op:operator pos:line="379" pos:column="25">new</op:operator> <call><name pos:line="379" pos:column="29">IntPtr</name><argument_list pos:line="379" pos:column="35">()</argument_list></call></expr></init></decl>;</decl_stmt>
            <decl_stmt><decl><type><name><name pos:line="380" pos:column="13">Image</name><op:operator pos:line="380" pos:column="18">.</op:operator><name pos:line="380" pos:column="19">GetThumbnailImageAbort</name></name></type> <name pos:line="380" pos:column="42">imageAbort</name> =<init pos:line="380" pos:column="54"> <expr><name pos:line="380" pos:column="55">AbortThumb</name></expr></init></decl>;</decl_stmt>

            <return pos:line="382" pos:column="13">return <expr><call><name><name pos:line="382" pos:column="20">image</name><op:operator pos:line="382" pos:column="25">.</op:operator><name pos:line="382" pos:column="26">GetThumbnailImage</name></name><argument_list pos:line="382" pos:column="43">(<argument><expr><name pos:line="382" pos:column="44">newWidth</name></expr></argument><op:operator pos:line="382" pos:column="52">,</op:operator> <argument><expr><name pos:line="382" pos:column="54">newHeight</name></expr></argument><op:operator pos:line="382" pos:column="63">,</op:operator> <argument><expr><name pos:line="382" pos:column="65">imageAbort</name></expr></argument><op:operator pos:line="382" pos:column="75">,</op:operator> <argument><expr><name pos:line="382" pos:column="77">ip</name></expr></argument>)</argument_list></call></expr>;</return>
        }</block></function>

        <comment type="line" pos:line="385" pos:column="9">//Never called in this version of GDI+, but needed.</comment>
        <comment type="line" pos:line="386" pos:column="9">//</comment>
        <function><type><specifier pos:line="387" pos:column="9">private</specifier> <specifier pos:line="387" pos:column="17">static</specifier> <name pos:line="387" pos:column="24">bool</name></type> <name pos:line="387" pos:column="29">AbortThumb</name><parameter_list pos:line="387" pos:column="39">()</parameter_list>
        <block pos:line="388" pos:column="9">{
            <return pos:line="389" pos:column="13">return <expr><lit:literal type="boolean" pos:line="389" pos:column="20">false</lit:literal></expr>;</return>
        }</block></function>



        <decl_stmt><decl><type><specifier pos:line="394" pos:column="9">public</specifier> <specifier pos:line="394" pos:column="16">event</specifier> <name pos:line="394" pos:column="22">ImageCapturingEventHandler</name></type> <name pos:line="394" pos:column="49">ImageCapturing</name></decl>;</decl_stmt>
        <decl_stmt><decl><type><specifier pos:line="395" pos:column="9">public</specifier> <specifier pos:line="395" pos:column="16">event</specifier> <name pos:line="395" pos:column="22">ImageCapturedEventHandler</name></type> <name pos:line="395" pos:column="48">ImageCaptured</name></decl>;</decl_stmt>
        <decl_stmt><decl><type><specifier pos:line="396" pos:column="9">public</specifier> <specifier pos:line="396" pos:column="16">event</specifier> <name pos:line="396" pos:column="22">ImageCaptureInitializedEventHandler</name></type> <name pos:line="396" pos:column="58">ImageCaptureInitialized</name></decl>;</decl_stmt>



        <function><type><specifier pos:line="400" pos:column="9">protected</specifier> <name pos:line="400" pos:column="19">void</name></type> <name pos:line="400" pos:column="24">OnImageCaptureInitialized</name><parameter_list pos:line="400" pos:column="49">(<param><decl><type><name pos:line="400" pos:column="50">ImageCaptureInitializedEventArgs</name></type> <name pos:line="400" pos:column="83">e</name></decl></param>)</parameter_list>
        <block pos:line="401" pos:column="9">{
            <decl_stmt><decl><type><name pos:line="402" pos:column="13">ImageCaptureInitializedEventHandler</name></type> <name pos:line="402" pos:column="49">handler</name> =<init pos:line="402" pos:column="58"> <expr><name pos:line="402" pos:column="59">ImageCaptureInitialized</name></expr></init></decl>;</decl_stmt>
            <if pos:line="403" pos:column="13">if <condition pos:line="403" pos:column="16">(<expr><name pos:line="403" pos:column="17">handler</name> <op:operator pos:line="403" pos:column="25">!=</op:operator> <name pos:line="403" pos:column="28">null</name></expr>)</condition><then pos:line="403" pos:column="33">
                <expr_stmt><expr><call><name pos:line="404" pos:column="17">handler</name><argument_list pos:line="404" pos:column="24">(<argument><expr><name pos:line="404" pos:column="25">this</name></expr></argument><op:operator pos:line="404" pos:column="29">,</op:operator> <argument><expr><name pos:line="404" pos:column="31">e</name></expr></argument>)</argument_list></call></expr>;</expr_stmt></then></if>
        }</block></function>

        <function><type><specifier pos:line="407" pos:column="9">protected</specifier> <name pos:line="407" pos:column="19">void</name></type> <name pos:line="407" pos:column="24">OnImageCapturing</name><parameter_list pos:line="407" pos:column="40">(<param><decl><type><name pos:line="407" pos:column="41">ImageCapturingEventArgs</name></type> <name pos:line="407" pos:column="65">e</name></decl></param>)</parameter_list>
        <block pos:line="408" pos:column="9">{
            <decl_stmt><decl><type><name pos:line="409" pos:column="13">ImageCapturingEventHandler</name></type> <name pos:line="409" pos:column="40">handler</name> =<init pos:line="409" pos:column="49"> <expr><name pos:line="409" pos:column="50">ImageCapturing</name></expr></init></decl>;</decl_stmt>
            <if pos:line="410" pos:column="13">if <condition pos:line="410" pos:column="16">(<expr><name pos:line="410" pos:column="17">handler</name> <op:operator pos:line="410" pos:column="25">!=</op:operator> <name pos:line="410" pos:column="28">null</name></expr>)</condition><then pos:line="410" pos:column="33">
                <expr_stmt><expr><call><name pos:line="411" pos:column="17">handler</name><argument_list pos:line="411" pos:column="24">(<argument><expr><name pos:line="411" pos:column="25">this</name></expr></argument><op:operator pos:line="411" pos:column="29">,</op:operator> <argument><expr><name pos:line="411" pos:column="31">e</name></expr></argument>)</argument_list></call></expr>;</expr_stmt></then></if>
        }</block></function>

        <function><type><specifier pos:line="414" pos:column="9">protected</specifier> <name pos:line="414" pos:column="19">void</name></type> <name pos:line="414" pos:column="24">OnImageCaptured</name><parameter_list pos:line="414" pos:column="39">(<param><decl><type><name pos:line="414" pos:column="40">ImageCapturedEventArgs</name></type> <name pos:line="414" pos:column="63">e</name></decl></param>)</parameter_list>
        <block pos:line="415" pos:column="9">{
            <decl_stmt><decl><type><name pos:line="416" pos:column="13">ImageCapturedEventHandler</name></type> <name pos:line="416" pos:column="39">handler</name> =<init pos:line="416" pos:column="48"> <expr><name pos:line="416" pos:column="49">ImageCaptured</name></expr></init></decl>;</decl_stmt>
            <if pos:line="417" pos:column="13">if <condition pos:line="417" pos:column="16">(<expr><name pos:line="417" pos:column="17">handler</name> <op:operator pos:line="417" pos:column="25">!=</op:operator> <name pos:line="417" pos:column="28">null</name></expr>)</condition><then pos:line="417" pos:column="33">
                <expr_stmt><expr><call><name pos:line="418" pos:column="17">handler</name><argument_list pos:line="418" pos:column="24">(<argument><expr><name pos:line="418" pos:column="25">this</name></expr></argument><op:operator pos:line="418" pos:column="29">,</op:operator> <argument><expr><name pos:line="418" pos:column="31">e</name></expr></argument>)</argument_list></call></expr>;</expr_stmt></then></if>
        }</block></function>


    }
}
</unit>
